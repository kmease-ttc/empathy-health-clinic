import{j as e,a9 as H,u as x,C as i,c as d,d as c,e as l,F as j}from"./index-CgsemtNf.js";import{B as I}from"./badge-CYF5D6iW.js";import{T as O}from"./target-DwMvWJz-.js";import{M as Y}from"./mouse-pointer-click-RfRXnob0.js";import{C as _}from"./chart-column-BjIUzNqI.js";import{F as J}from"./file-text-DR4XjJnC.js";import{T as X}from"./triangle-alert-069s_g3B.js";function o({className:n,...h}){return e.jsx("div",{className:H("animate-pulse rounded-md bg-muted",n),...h})}function re(){var T,K,q;const{data:n,isLoading:h}=x({queryKey:["/api/analytics/utm/leads-by-source"]}),{data:p,isLoading:y}=x({queryKey:["/api/analytics/utm/leads-by-campaign"]}),{data:r,isLoading:w}=x({queryKey:["/api/analytics/utm/leads-by-term"]}),{data:v,isLoading:Q}=x({queryKey:["/api/analytics/utm/leads-by-landing-page"]}),{data:b}=x({queryKey:["/api/analytics/utm/page-views-by-source"]}),{data:C}=x({queryKey:["/api/analytics/utm/page-views-by-campaign"]}),{data:u,isLoading:R}=x({queryKey:["/api/leads"]}),L=(()=>{if(!u)return[];const s=[],a=u.reduce((t,m)=>{if(!m.utmTerm||!m.landingPage)return t;const g=`${m.utmTerm}|${m.landingPage}`;return t[g]=(t[g]||0)+1,t},{});return Object.entries(a).forEach(([t,m])=>{const[g,A]=t.split("|"),W=g.toLowerCase(),U=A.toLowerCase();let f="good",N="Keyword aligns with landing page content";const M=W.split(/\s+/),E=U.split(/[\/\-_]/),S=M.filter(D=>E.some(F=>F.includes(D)||D.includes(F)));S.length===0?(f="poor",N=`Keyword "${g}" doesn't match landing page URL. Consider creating a dedicated landing page or updating ad targeting.`):S.length<M.length/2&&(f="moderate",N="Partial match between keyword and landing page. Could improve relevance."),f!=="good"&&s.push({keyword:g,landingPage:A,count:m,matchQuality:f,reason:N})}),s.sort((t,m)=>m.count-t.count)})(),P=(s,a)=>a===0?"0.00":(s/a*100).toFixed(2),G=()=>!n||!b?[]:n.map(s=>{const a=b.find(t=>t.utmSource===s.utmSource);return{source:s.utmSource||"Direct",conversions:s.count,views:(a==null?void 0:a.count)||0,conversionRate:P(s.count,(a==null?void 0:a.count)||0)}}),z=()=>!p||!C?[]:p.map(s=>{const a=C.find(t=>t.utmCampaign===s.utmCampaign);return{campaign:s.utmCampaign||"None",conversions:s.count,views:(a==null?void 0:a.count)||0,conversionRate:P(s.count,(a==null?void 0:a.count)||0)}}),$=G(),k=z();return e.jsx("div",{className:"min-h-screen bg-background",children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2","data-testid":"title-google-ads",children:"Google Ads Performance"}),e.jsx("p",{className:"text-muted-foreground",children:"Track conversions, optimize campaigns, and identify which keywords drive patient acquisition"})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4 mb-8",children:[e.jsxs(i,{children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Total Conversions"}),e.jsx(O,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(l,{children:[h?e.jsx(o,{className:"h-8 w-20"}):e.jsx("div",{className:"text-2xl font-bold","data-testid":"text-total-conversions",children:(n==null?void 0:n.reduce((s,a)=>s+a.count,0))||0}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"From all traffic sources"})]})]}),e.jsxs(i,{children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Google Ads Conversions"}),e.jsx(Y,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(l,{children:[h?e.jsx(o,{className:"h-8 w-20"}):e.jsx("div",{className:"text-2xl font-bold","data-testid":"text-google-ads-conversions",children:((T=n==null?void 0:n.find(s=>{var a,t;return((a=s.utmSource)==null?void 0:a.toLowerCase().includes("google"))||((t=s.utmSource)==null?void 0:t.toLowerCase().includes("cpc"))}))==null?void 0:T.count)||0}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"From Google Ads campaigns"})]})]}),e.jsxs(i,{children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Active Campaigns"}),e.jsx(_,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(l,{children:[y?e.jsx(o,{className:"h-8 w-20"}):e.jsx("div",{className:"text-2xl font-bold","data-testid":"text-active-campaigns",children:(p==null?void 0:p.filter(s=>s.utmCampaign).length)||0}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Campaigns with conversions"})]})]}),e.jsxs(i,{children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Top Keyword"}),e.jsx(J,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(l,{children:w?e.jsx(o,{className:"h-8 w-full"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-lg font-bold truncate","data-testid":"text-top-keyword",children:((K=r==null?void 0:r[0])==null?void 0:K.utmTerm)||"No data"}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[((q=r==null?void 0:r[0])==null?void 0:q.count)||0," conversions"]})]})})]})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2 mb-8",children:[e.jsxs(i,{children:[e.jsxs(d,{children:[e.jsx(c,{children:"Conversions by Traffic Source"}),e.jsx(j,{children:"Which channels drive the most leads"})]}),e.jsx(l,{children:h?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(s=>e.jsx(o,{className:"h-16 w-full"},s))}):$.length>0?e.jsx("div",{className:"space-y-4",children:$.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-muted/30 rounded-lg hover-elevate","data-testid":`card-source-${a}`,children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium","data-testid":`text-source-name-${a}`,children:s.source}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[s.views," views"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl font-bold","data-testid":`text-source-conversions-${a}`,children:s.conversions}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[s.conversionRate,"% rate"]})]})]},a))}):e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No conversion data available yet"})})]}),e.jsxs(i,{children:[e.jsxs(d,{children:[e.jsx(c,{children:"Conversions by Campaign"}),e.jsx(j,{children:"Performance of individual campaigns"})]}),e.jsx(l,{children:y?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(s=>e.jsx(o,{className:"h-16 w-full"},s))}):k.length>0?e.jsx("div",{className:"space-y-4",children:k.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-muted/30 rounded-lg hover-elevate","data-testid":`card-campaign-${a}`,children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium","data-testid":`text-campaign-name-${a}`,children:s.campaign}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[s.views," views"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl font-bold","data-testid":`text-campaign-conversions-${a}`,children:s.conversions}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[s.conversionRate,"% rate"]})]})]},a))}):e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No campaign data available yet"})})]})]}),e.jsxs(i,{className:"mb-8",children:[e.jsxs(d,{children:[e.jsx(c,{children:"Keyword Performance"}),e.jsx(j,{children:"Which search terms convert best"})]}),e.jsx(l,{children:w?e.jsx("div",{className:"space-y-4",children:[1,2,3,4,5].map(s=>e.jsx(o,{className:"h-12 w-full"},s))}):r&&r.length>0?e.jsx("div",{className:"space-y-3",children:r.slice(0,10).map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/30 rounded-lg hover-elevate","data-testid":`card-keyword-${a}`,children:[e.jsx("div",{className:"flex-1",children:e.jsx("span",{className:"font-medium","data-testid":`text-keyword-term-${a}`,children:s.utmTerm||"Unknown"})}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-xl font-bold","data-testid":`text-keyword-conversions-${a}`,children:s.count}),e.jsx("span",{className:"text-sm text-muted-foreground ml-2",children:"conversions"})]})]},a))}):e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No keyword data available yet"})})]}),e.jsxs(i,{className:"mb-8",children:[e.jsxs(d,{children:[e.jsx(c,{children:"Landing Page Performance"}),e.jsx(j,{children:"Conversions by destination page"})]}),e.jsx(l,{children:Q?e.jsx("div",{className:"space-y-4",children:[1,2,3,4].map(s=>e.jsx(o,{className:"h-12 w-full"},s))}):v&&v.length>0?e.jsx("div",{className:"space-y-3",children:v.slice(0,10).map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/30 rounded-lg hover-elevate","data-testid":`card-landing-page-${a}`,children:[e.jsx("div",{className:"flex-1",children:e.jsx("span",{className:"font-medium text-sm","data-testid":`text-landing-page-url-${a}`,children:s.landingPage||"Direct"})}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-xl font-bold","data-testid":`text-landing-page-conversions-${a}`,children:s.count}),e.jsx("span",{className:"text-sm text-muted-foreground ml-2",children:"conversions"})]})]},a))}):e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No landing page data available yet"})})]}),e.jsxs(i,{children:[e.jsxs(d,{children:[e.jsxs(c,{className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-5 w-5 text-warning"}),"Landing Page Match Quality"]}),e.jsx(j,{children:"Identify misaligned keyword-to-page combinations to improve Quality Score and conversion rates"})]}),e.jsx(l,{children:R?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(s=>e.jsx(o,{className:"h-24 w-full"},s))}):L.length>0?e.jsx("div",{className:"space-y-4",children:L.slice(0,10).map((s,a)=>e.jsxs("div",{className:"p-4 bg-muted/30 rounded-lg border-l-4",style:{borderLeftColor:s.matchQuality==="poor"?"hsl(var(--destructive))":"hsl(var(--warning))"},"data-testid":`card-mismatch-${a}`,children:[e.jsx("div",{className:"flex items-start justify-between mb-2",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(I,{variant:s.matchQuality==="poor"?"destructive":"secondary","data-testid":`badge-match-quality-${a}`,children:s.matchQuality==="poor"?"Poor Match":"Moderate Match"}),e.jsxs("span",{className:"text-sm font-medium","data-testid":`text-mismatch-count-${a}`,children:[s.count," conversions"]})]}),e.jsxs("p",{className:"text-sm font-medium mb-1","data-testid":`text-mismatch-keyword-${a}`,children:["Keyword: ",e.jsx("span",{className:"text-primary",children:s.keyword})]}),e.jsxs("p",{className:"text-sm text-muted-foreground truncate","data-testid":`text-mismatch-landing-page-${a}`,children:["Landing Page: ",s.landingPage]})]})}),e.jsx("p",{className:"text-sm text-muted-foreground","data-testid":`text-mismatch-reason-${a}`,children:s.reason})]},a))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-muted-foreground mb-2",children:u&&u.length>0?"âœ… All keywords are well-aligned with landing pages!":"No conversion data available yet to analyze"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:u&&u.length>0?"Your Google Ads campaigns are well-optimized for keyword-to-page relevance.":"Start driving traffic with UTM-tagged Google Ads to see match quality insights"})]})})]})]})})}export{re as default};
