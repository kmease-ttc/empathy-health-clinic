import{O as se,N as ae,G as h,u as ne,j as e,B as k,C as u,e as g,c as B,d as z,W as le,aD as ce,aE as de,aF as me,a1 as ye}from"./index-CgsemtNf.js";import{B as d}from"./badge-CYF5D6iW.js";import{P as pe}from"./progress-B7OgBQCH.js";import{A as he}from"./arrow-left-CINmuYo-.js";import{D as ue}from"./download-DxRUFOXP.js";import{R as T}from"./refresh-cw-BXMHVCn8.js";import{S as ge}from"./search-CgS1i4Xf.js";import{H as xe}from"./history-BAwmUNFI.js";const j=[{keyword:"psychiatrist near me",volume:49500,priority:"critical",category:"intent",notes:"Top priority - highest intent"},{keyword:"psychiatrist orlando",volume:2900,priority:"critical",category:"core",notes:"Primary geo target"},{keyword:"psychiatry orlando",volume:720,priority:"critical",category:"core"},{keyword:"mental health clinic orlando",volume:590,priority:"critical",category:"core"},{keyword:"psychiatric clinic orlando",volume:390,priority:"critical",category:"core"},{keyword:"psychiatrist accepting new patients orlando",volume:480,priority:"high",category:"intent",notes:"High conversion"},{keyword:"adhd psychiatrist orlando",volume:590,priority:"high",category:"condition"},{keyword:"anxiety psychiatrist orlando",volume:480,priority:"high",category:"condition"},{keyword:"depression psychiatrist orlando",volume:390,priority:"high",category:"condition"},{keyword:"medication management orlando",volume:480,priority:"high",category:"service"},{keyword:"telepsychiatry orlando",volume:320,priority:"high",category:"service"},{keyword:"online psychiatrist orlando",volume:390,priority:"high",category:"service"},{keyword:"best psychiatrist orlando",volume:320,priority:"high",category:"intent"},{keyword:"psychiatrist winter park",volume:260,priority:"high",category:"location"},{keyword:"same day psychiatrist orlando",volume:210,priority:"high",category:"intent",notes:"Urgent care"},{keyword:"psychiatrist for anxiety near me",volume:1300,priority:"high",category:"intent"},{keyword:"psychiatrist for depression near me",volume:880,priority:"high",category:"intent"},{keyword:"psychiatric evaluation orlando",volume:210,priority:"medium",category:"service"},{keyword:"psychiatric services orlando",volume:170,priority:"medium",category:"service"},{keyword:"mental health psychiatrist orlando",volume:170,priority:"medium",category:"core"},{keyword:"adhd testing orlando",volume:320,priority:"medium",category:"condition"},{keyword:"adhd evaluation orlando",volume:260,priority:"medium",category:"condition"},{keyword:"anxiety treatment orlando",volume:320,priority:"medium",category:"condition"},{keyword:"depression treatment orlando",volume:260,priority:"medium",category:"condition"},{keyword:"bipolar psychiatrist orlando",volume:170,priority:"medium",category:"condition"},{keyword:"ptsd psychiatrist orlando",volume:140,priority:"medium",category:"condition"},{keyword:"virtual psychiatrist orlando",volume:170,priority:"medium",category:"service"},{keyword:"psychiatrist orlando accepts insurance",volume:140,priority:"medium",category:"insurance"},{keyword:"psychiatrist orlando accepts bcbs",volume:110,priority:"medium",category:"insurance"},{keyword:"psychiatrist orlando accepts cigna",volume:90,priority:"medium",category:"insurance"},{keyword:"psychiatrist orlando accepts aetna",volume:90,priority:"medium",category:"insurance"},{keyword:"psychiatrist orlando accepts united healthcare",volume:90,priority:"medium",category:"insurance"},{keyword:"psychiatrist near ucf",volume:110,priority:"medium",category:"location",notes:"College students"},{keyword:"psychiatrist near lake nona",volume:70,priority:"medium",category:"location"},{keyword:"psychiatrist near downtown orlando",volume:90,priority:"medium",category:"location"},{keyword:"trauma psychiatrist orlando",volume:140,priority:"medium",category:"condition"},{keyword:"urgent psychiatrist orlando",volume:110,priority:"medium",category:"intent"},{keyword:"walk in psychiatrist orlando",volume:90,priority:"medium",category:"intent"},{keyword:"adult psychiatrist orlando",volume:110,priority:"medium",category:"service"},{keyword:"mental health doctor orlando",volume:210,priority:"medium",category:"core"},{keyword:"psychiatry near me",volume:1900,priority:"low",category:"intent"},{keyword:"psychiatry winter park",volume:70,priority:"low",category:"location"},{keyword:"psychiatric assessment orlando",volume:50,priority:"low",category:"service"},{keyword:"psychiatric medication orlando",volume:70,priority:"low",category:"service"},{keyword:"psychiatry accepting new patients orlando",volume:70,priority:"low",category:"intent"},{keyword:"same day psychiatry orlando",volume:50,priority:"low",category:"intent"},{keyword:"emergency psychiatrist orlando",volume:70,priority:"low",category:"intent"},{keyword:"online psychiatry orlando",volume:70,priority:"low",category:"service"},{keyword:"online psychiatrist florida",volume:260,priority:"low",category:"service"},{keyword:"online psychiatry florida",volume:90,priority:"low",category:"service"},{keyword:"virtual psychiatry orlando",volume:50,priority:"low",category:"service"},{keyword:"top rated psychiatrist orlando",volume:70,priority:"low",category:"intent"},{keyword:"family psychiatrist orlando",volume:50,priority:"low",category:"service"},{keyword:"medication management psychiatry orlando",volume:50,priority:"low",category:"service"},{keyword:"mental health medication orlando",volume:70,priority:"low",category:"service"},{keyword:"anxiety therapy orlando",volume:170,priority:"low",category:"condition"},{keyword:"anxiety medication orlando",volume:90,priority:"low",category:"condition"},{keyword:"adhd psychiatry orlando",volume:50,priority:"low",category:"condition"},{keyword:"adhd treatment orlando",volume:170,priority:"low",category:"condition"},{keyword:"adhd medication orlando",volume:110,priority:"low",category:"condition"},{keyword:"depression psychiatry orlando",volume:50,priority:"low",category:"condition"},{keyword:"depression medication orlando",volume:70,priority:"low",category:"condition"},{keyword:"bipolar psychiatry orlando",volume:30,priority:"low",category:"condition"},{keyword:"bipolar treatment orlando",volume:70,priority:"low",category:"condition"},{keyword:"ptsd psychiatry orlando",volume:30,priority:"low",category:"condition"},{keyword:"ptsd treatment orlando",volume:90,priority:"low",category:"condition"},{keyword:"ocd psychiatrist orlando",volume:70,priority:"low",category:"condition"},{keyword:"ocd psychiatry orlando",volume:30,priority:"low",category:"condition"},{keyword:"schizophrenia psychiatrist orlando",volume:50,priority:"low",category:"condition"},{keyword:"schizophrenia treatment orlando",volume:50,priority:"low",category:"condition"},{keyword:"panic attack psychiatrist orlando",volume:50,priority:"low",category:"condition"},{keyword:"panic disorder psychiatrist orlando",volume:30,priority:"low",category:"condition"},{keyword:"insomnia psychiatrist orlando",volume:50,priority:"low",category:"condition"},{keyword:"sleep medication psychiatrist orlando",volume:30,priority:"low",category:"condition"},{keyword:"behavioral health orlando psychiatrist",volume:50,priority:"low",category:"core"},{keyword:"psychiatry orlando accepts insurance",volume:30,priority:"low",category:"insurance"},{keyword:"psychiatry orlando accepts cigna",volume:20,priority:"low",category:"insurance"},{keyword:"psychiatry orlando accepts aetna",volume:20,priority:"low",category:"insurance"},{keyword:"psychiatry orlando accepts bcbs",volume:20,priority:"low",category:"insurance"},{keyword:"psychiatrist orlando accepts umr",volume:30,priority:"low",category:"insurance"},{keyword:"psychiatry orlando accepts umr",volume:10,priority:"low",category:"insurance"},{keyword:"psychiatry orlando accepts united healthcare",volume:20,priority:"low",category:"insurance"},{keyword:"psychiatrist orlando accepts medicare",volume:70,priority:"low",category:"insurance"},{keyword:"psychiatry orlando accepts medicare",volume:20,priority:"low",category:"insurance"},{keyword:"psychiatrist orlando accepts medicaid",volume:50,priority:"low",category:"insurance"},{keyword:"psychiatry orlando accepts medicaid",volume:20,priority:"low",category:"insurance"},{keyword:"local psychiatrist orlando",volume:50,priority:"low",category:"intent"},{keyword:"affordable psychiatrist orlando",volume:70,priority:"low",category:"intent"},{keyword:"low cost psychiatrist orlando",volume:50,priority:"low",category:"intent"},{keyword:"private psychiatrist orlando",volume:50,priority:"low",category:"service"},{keyword:"psychiatrist near winter park",volume:50,priority:"low",category:"location"},{keyword:"mental health provider orlando",volume:90,priority:"low",category:"core"},{keyword:"psychiatrist specializing in adhd orlando",volume:50,priority:"low",category:"condition"},{keyword:"psychiatrist specializing in anxiety orlando",volume:50,priority:"low",category:"condition"},{keyword:"psychiatrist specializing in depression orlando",volume:50,priority:"low",category:"condition"}],c=j.map(E=>E.keyword);function Se(){const[,E]=se(),{toast:p}=ae(),[y,b]=h.useState(new Map),[x,N]=h.useState(!1),[C,S]=h.useState(0),[V,P]=h.useState(""),[F,q]=h.useState(""),[R,W]=h.useState("priority"),[$,Y]=h.useState("all"),[I,Z]=h.useState("all"),{data:A,refetch:J}=ne({queryKey:["serp-ranking-trends"],queryFn:async()=>{const t=await fetch("/api/serp/ranking-trends",{credentials:"include"});if(!t.ok)throw new Error("Failed to fetch trends");return t.json()},staleTime:5*60*1e3}),G=(A==null?void 0:A.trends)||{};h.useEffect(()=>{const t=localStorage.getItem("serp_rankings");if(t)try{const r=JSON.parse(t);b(new Map(Object.entries(r)))}catch(r){console.error("Failed to load saved rankings:",r)}},[]);const D=t=>{const r=Object.fromEntries(t);localStorage.setItem("serp_rankings",JSON.stringify(r))},L=async t=>{const r=t.filter(i=>i.keyword&&!i.error&&i.position!==null&&i.position!==void 0);if(r.length===0){console.log("No valid rankings with positions to save");return}const o=r.map(i=>({keyword:i.keyword,position:i.position,url:i.url,competitorPositions:i.competitor_positions}));try{const i=await ye("POST","/api/serp/ranking-history/batch",{rankings:o}),n=await i.json();(i.status===207||!n.success)&&(console.warn("Partial save to database:",n.message),p({title:"Partial Save",description:n.message||"Some rankings could not be saved to history.",variant:"destructive"}))}catch(i){console.error("Failed to save rankings to database:",i),p({title:"History Save Failed",description:"Could not save ranking history to database.",variant:"destructive"})}finally{J()}},M=({keyword:t,period:r})=>{const o=G[t];if(!o)return e.jsx("span",{className:"text-muted-foreground text-xs",children:"-"});const i={"7d":{position:o.position7dAgo,change:o.change7d,label:"7 days ago"},"30d":{position:o.position30dAgo,change:o.change30d,label:"30 days ago"},"90d":{position:o.position90dAgo,change:o.change90d,label:"90 days ago"}},{position:n,change:l,label:a}=i[r];if(n==null)return e.jsx("span",{className:"text-muted-foreground text-xs",children:"-"});const s=l!==null&&l>0,v=l!==null&&l<0,f=o.current,m=()=>s?"text-green-600 dark:text-green-400":v?"text-red-600 dark:text-red-400":"text-muted-foreground",ie=()=>l===null||l===0?"No change":s?`Improved ${l} positions`:`Declined ${Math.abs(l)} positions`;return e.jsxs(ce,{children:[e.jsx(de,{asChild:!0,children:e.jsxs("span",{className:`text-sm font-medium ${m()}`,children:[n,l!==null&&l!==0&&e.jsx("span",{className:"ml-0.5 text-xs",children:s?"↑":"↓"})]})}),e.jsxs(me,{children:[e.jsxs("p",{className:"font-medium",children:["Position ",a,": #",n]}),e.jsxs("p",{className:"text-xs",children:["Current: #",f??"N/A"]}),e.jsx("p",{className:"text-xs",children:ie()})]})]})},_=async(t,r=2)=>{for(let o=0;o<=r;o++)try{const i=new AbortController,n=setTimeout(()=>i.abort(),3e4),l=await fetch(`/api/serp/ranking?q=${encodeURIComponent(t)}`,{signal:i.signal});clearTimeout(n);const a=await l.json();if(!a.success)throw new Error(a.error||"Failed to fetch ranking");return{keyword:t,position:a.position,url:a.url,competitor_positions:a.competitor_positions,lastChecked:new Date().toISOString()}}catch(i){if(o<r){await new Promise(n=>setTimeout(n,2e3));continue}return{keyword:t,position:null,url:null,error:i.message,lastChecked:new Date().toISOString()}}return{keyword:t,position:null,url:null,error:"Max retries exceeded",lastChecked:new Date().toISOString()}},Q=async()=>{N(!0),S(0);const t=new Map(y),r=[],o=3;for(let i=0;i<c.length;i+=o){const n=c.slice(i,i+o);P(`Batch ${Math.floor(i/o)+1}: ${n.join(", ").substring(0,50)}...`),(await Promise.all(n.map(a=>_(a)))).forEach(a=>{t.set(a.keyword,a),r.push(a)}),b(new Map(t)),D(t),S((i+n.length)/c.length*100),i+o<c.length&&await new Promise(a=>setTimeout(a,5e3))}await L(r),N(!1),P(""),p({title:"Rankings Updated",description:`Checked ${c.length} keywords successfully.`})},X=async()=>{const t=c.filter(o=>{const i=y.get(o);return!!(!i||!i.lastChecked||i.error)});if(t.length===0){p({title:"All Checked",description:"All keywords have valid position data."});return}const r=t.slice(0,5);p({title:"Checking Rankings",description:`Checking ${r.length} of ${t.length} unchecked keywords...`}),await K(r)},ee=()=>{localStorage.removeItem("serp_rankings"),b(new Map),p({title:"Cache Cleared",description:"All saved rankings have been cleared."})},K=async t=>{N(!0),S(0);const r=new Map(y),o=[],i=3;let n=0,l=0,a="";for(let s=0;s<t.length;s+=i){const v=t.slice(s,s+i);P(`Batch ${Math.floor(s/i)+1}: ${v.join(", ").substring(0,50)}...`),(await Promise.all(v.map(m=>_(m)))).forEach(m=>{r.set(m.keyword,m),o.push(m),m.error?(l++,a=m.error):m.position!==null&&n++}),b(new Map(r)),D(r),S((s+v.length)/t.length*100),s+i<t.length&&await new Promise(m=>setTimeout(m,5e3))}await L(o),N(!1),P(""),l>0?p({title:"API Errors Occurred",description:`${l} keywords failed. Error: ${a}. You may be out of API credits or rate limited.`,variant:"destructive"}):n>0?p({title:"Rankings Updated",description:`Found rankings for ${n} of ${t.length} keywords.`}):p({title:"No Rankings Found",description:`None of the ${t.length} keywords rank in top 20 results.`})},te=()=>{const t=["Keyword","Volume","Priority","Category","Position","URL","Healing Psychiatry","MyMindCare","Orlando Health","Last Checked"],r=j.map(a=>{var v,f,m;const s=y.get(a.keyword);return[a.keyword,a.volume,a.priority,a.category,(s==null?void 0:s.position)??"Not checked",(s==null?void 0:s.url)??"",((v=s==null?void 0:s.competitor_positions)==null?void 0:v["healingpsychiatryflorida.com"])??"",((f=s==null?void 0:s.competitor_positions)==null?void 0:f["mymindcarecenter.com"])??"",((m=s==null?void 0:s.competitor_positions)==null?void 0:m["orlandohealth.com"])??"",s!=null&&s.lastChecked?new Date(s.lastChecked).toLocaleString():""].join(",")}),o=[t.join(","),...r].join(`
`),i=new Blob([o],{type:"text/csv"}),n=URL.createObjectURL(i),l=document.createElement("a");l.href=n,l.download=`serp_rankings_${new Date().toISOString().split("T")[0]}.csv`,l.click()},O=t=>j.find(r=>r.keyword===t),H=j.filter(t=>{const r=t.keyword.toLowerCase().includes(F.toLowerCase()),o=$==="all"||t.category===$,i=I==="all"||t.priority===I;return r&&o&&i}).map(t=>t.keyword),U={critical:0,high:1,medium:2,low:3},re=[...H].sort((t,r)=>{var n,l;const o=O(t),i=O(r);if(R==="position"){const a=((n=y.get(t))==null?void 0:n.position)??999,s=((l=y.get(r))==null?void 0:l.position)??999;return a-s}if(R==="volume")return((i==null?void 0:i.volume)??0)-((o==null?void 0:o.volume)??0);if(R==="priority"){const a=U[(o==null?void 0:o.priority)??"low"],s=U[(i==null?void 0:i.priority)??"low"];return a!==s?a-s:((i==null?void 0:i.volume)??0)-((o==null?void 0:o.volume)??0)}return t.localeCompare(r)}),oe=(t,r,o)=>o?e.jsx(d,{variant:"destructive",className:"bg-red-600 text-white",children:"Error"}):r?t==null?e.jsx(d,{variant:"outline",className:"bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-300 border-orange-300",children:"Not Found"}):t<=3?e.jsx(d,{className:"bg-green-600 text-white",children:t}):t<=10?e.jsx(d,{className:"bg-blue-600 text-white",children:t}):t<=20?e.jsx(d,{className:"bg-yellow-600 text-white",children:t}):e.jsxs(d,{variant:"destructive",children:[t,"+"]}):e.jsx(d,{variant:"outline",className:"bg-muted",children:"Not checked"}),w={top3:c.filter(t=>{var o;const r=(o=y.get(t))==null?void 0:o.position;return r!=null&&r>=1&&r<=3}).length,top4to10:c.filter(t=>{var o;const r=(o=y.get(t))==null?void 0:o.position;return r!=null&&r>=4&&r<=10}).length,top11to20:c.filter(t=>{var o;const r=(o=y.get(t))==null?void 0:o.position;return r!=null&&r>=11&&r<=20}).length,beyond20:c.filter(t=>{var o;const r=(o=y.get(t))==null?void 0:o.position;return r!=null&&r>20}).length,notRanking:c.filter(t=>{const r=y.get(t);return r&&r.lastChecked&&r.position===null&&!r.error}).length,neverChecked:c.filter(t=>{const r=y.get(t);return!r||!r.lastChecked}).length,checked:c.filter(t=>{const r=y.get(t);return r&&r.lastChecked}).length};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("header",{className:"border-b border-border sticky top-0 bg-background/95 backdrop-blur-md z-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(k,{variant:"ghost",size:"icon",onClick:()=>E("/admin"),"data-testid":"button-back",children:e.jsx(he,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-2xl font-sans font-medium",children:"SERP Rankings Dashboard"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{variant:"outline",onClick:ee,disabled:x||w.checked===0,"data-testid":"button-clear",children:"Clear Cache"}),e.jsxs(k,{variant:"outline",onClick:te,disabled:w.checked===0,"data-testid":"button-export",children:[e.jsx(ue,{className:"w-4 h-4 mr-2"}),"Export CSV"]}),e.jsxs(k,{variant:"outline",onClick:X,disabled:x,"data-testid":"button-check-unchecked",children:[e.jsx(T,{className:`w-4 h-4 mr-2 ${x?"animate-spin":""}`}),"Check Unchecked Only"]}),e.jsxs(k,{onClick:Q,disabled:x,"data-testid":"button-check-all",children:[e.jsx(T,{className:`w-4 h-4 mr-2 ${x?"animate-spin":""}`}),x?"Checking...":"Check All Rankings"]})]})]})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-6 py-8",children:[x&&e.jsx(u,{className:"mb-6",children:e.jsxs(g,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsx(T,{className:"w-5 h-5 animate-spin text-primary"}),e.jsxs("span",{className:"font-medium",children:["Checking: ",V]})]}),e.jsx(pe,{value:C,className:"h-2"}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:[Math.round(C),"% complete (",Math.round(C/100*c.length),"/",c.length," keywords)"]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Processing 3 keywords per batch with 5s delay. Estimated time: ",Math.round((c.length-Math.round(C/100*c.length))/3*5/60)," minutes remaining."]})]})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4 mb-6",children:[e.jsx(u,{children:e.jsxs(g,{className:"pt-6 text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:w.top3}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"#1-3"})]})}),e.jsx(u,{children:e.jsxs(g,{className:"pt-6 text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600",children:w.top4to10}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"#4-10"})]})}),e.jsx(u,{children:e.jsxs(g,{className:"pt-6 text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-yellow-600",children:w.top11to20}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"#11-20"})]})}),e.jsx(u,{children:e.jsxs(g,{className:"pt-6 text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-orange-600",children:w.beyond20}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"#21+"})]})}),e.jsx(u,{children:e.jsxs(g,{className:"pt-6 text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-red-600",children:w.notRanking}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Not Found"})]})}),e.jsx(u,{children:e.jsxs(g,{className:"pt-6 text-center",children:[e.jsxs("div",{className:"text-3xl font-bold",children:[w.checked,"/",c.length]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Checked"})]})})]}),e.jsxs(u,{children:[e.jsx(B,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs(z,{children:[j.length," Target Keywords (Orlando 20mi radius)"]}),e.jsxs("div",{className:"relative",children:[e.jsx(ge,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(le,{placeholder:"Filter keywords...",value:F,onChange:t=>q(t.target.value),className:"pl-9 w-64","data-testid":"input-filter"})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("select",{value:I,onChange:t=>Z(t.target.value),className:"px-3 py-1.5 border rounded-md text-sm bg-background","data-testid":"select-priority",children:[e.jsx("option",{value:"all",children:"All Priorities"}),e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"})]}),e.jsxs("select",{value:$,onChange:t=>Y(t.target.value),className:"px-3 py-1.5 border rounded-md text-sm bg-background","data-testid":"select-category",children:[e.jsx("option",{value:"all",children:"All Categories"}),e.jsx("option",{value:"core",children:"Core"}),e.jsx("option",{value:"condition",children:"Condition"}),e.jsx("option",{value:"insurance",children:"Insurance"}),e.jsx("option",{value:"location",children:"Location"}),e.jsx("option",{value:"service",children:"Service"}),e.jsx("option",{value:"intent",children:"Intent"})]}),e.jsxs("select",{value:R,onChange:t=>W(t.target.value),className:"px-3 py-1.5 border rounded-md text-sm bg-background","data-testid":"select-sort",children:[e.jsx("option",{value:"priority",children:"Sort: Priority"}),e.jsx("option",{value:"volume",children:"Sort: Volume"}),e.jsx("option",{value:"position",children:"Sort: Position"}),e.jsx("option",{value:"keyword",children:"Sort: A-Z"})]}),e.jsxs("span",{className:"text-sm text-muted-foreground ml-2",children:["Showing ",H.length," of ",j.length," keywords"]})]})]})}),e.jsx(g,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-3 px-2 font-medium",children:"Keyword"}),e.jsx("th",{className:"text-center py-3 px-2 font-medium",children:"Vol."}),e.jsx("th",{className:"text-center py-3 px-2 font-medium hidden sm:table-cell",children:"Priority"}),e.jsx("th",{className:"text-center py-3 px-2 font-medium hidden sm:table-cell",children:"Category"}),e.jsx("th",{className:"text-center py-3 px-2 font-medium",children:"Position"}),e.jsx("th",{className:"text-center py-3 px-2 font-medium hidden md:table-cell",children:"7d"}),e.jsx("th",{className:"text-center py-3 px-2 font-medium hidden md:table-cell",children:"30d"}),e.jsx("th",{className:"text-center py-3 px-2 font-medium hidden lg:table-cell",children:"90d"}),e.jsx("th",{className:"text-left py-3 px-2 font-medium hidden xl:table-cell",children:"Ranking URL"}),e.jsx("th",{className:"text-center py-3 px-2 font-medium",children:"Check"})]})}),e.jsx("tbody",{children:re.map(t=>{var l;const r=y.get(t),o=O(t),i={critical:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",high:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200",medium:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",low:"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200"},n={core:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200",condition:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",insurance:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",location:"bg-teal-100 text-teal-800 dark:bg-teal-900 dark:text-teal-200",service:"bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-200",intent:"bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-200"};return e.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[e.jsxs("td",{className:"py-3 px-2",children:[e.jsx("span",{className:"font-medium",children:t}),(o==null?void 0:o.notes)&&e.jsx("div",{className:"text-xs text-muted-foreground",children:o.notes})]}),e.jsx("td",{className:"text-center py-3 px-2",children:e.jsx("span",{className:"font-mono text-xs",children:((l=o==null?void 0:o.volume)==null?void 0:l.toLocaleString())??"-"})}),e.jsx("td",{className:"text-center py-3 px-2 hidden sm:table-cell",children:e.jsx(d,{className:`text-xs ${i[(o==null?void 0:o.priority)??"low"]}`,children:(o==null?void 0:o.priority)??"-"})}),e.jsx("td",{className:"text-center py-3 px-2 hidden sm:table-cell",children:e.jsx(d,{variant:"outline",className:`text-xs ${n[(o==null?void 0:o.category)??"core"]}`,children:(o==null?void 0:o.category)??"-"})}),e.jsx("td",{className:"text-center py-3 px-2",children:oe(r==null?void 0:r.position,r==null?void 0:r.lastChecked,r==null?void 0:r.error)}),e.jsx("td",{className:"text-center py-3 px-2 hidden md:table-cell",children:e.jsx(M,{keyword:t,period:"7d"})}),e.jsx("td",{className:"text-center py-3 px-2 hidden md:table-cell",children:e.jsx(M,{keyword:t,period:"30d"})}),e.jsx("td",{className:"text-center py-3 px-2 hidden lg:table-cell",children:e.jsx(M,{keyword:t,period:"90d"})}),e.jsx("td",{className:"py-3 px-2 hidden xl:table-cell",children:r!=null&&r.url?e.jsx("a",{href:r.url,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline text-xs truncate block max-w-xs",children:r.url.replace("https://empathyhealthclinic.com","")}):e.jsx("span",{className:"text-muted-foreground",children:"-"})}),e.jsx("td",{className:"text-center py-3 px-2",children:e.jsx(k,{variant:"ghost",size:"sm",onClick:()=>K([t]),disabled:x,"data-testid":`button-check-${t.replace(/\s+/g,"-")}`,children:e.jsx(T,{className:"w-3 h-3"})})})]},t)})})]})})})]}),e.jsxs(u,{className:"mt-6",children:[e.jsx(B,{children:e.jsx(z,{children:"Legend"})}),e.jsxs(g,{children:[e.jsxs("div",{className:"flex flex-wrap gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{className:"bg-green-600 text-white",children:"1-3"}),e.jsx("span",{className:"text-sm",children:"#1-3 (Excellent)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{className:"bg-blue-600 text-white",children:"4-10"}),e.jsx("span",{className:"text-sm",children:"#4-10 (Page 1)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{className:"bg-yellow-600 text-white",children:"11-20"}),e.jsx("span",{className:"text-sm",children:"#11-20 (Page 2)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{variant:"destructive",children:"21+"}),e.jsx("span",{className:"text-sm",children:"#21+ (Page 3+)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{variant:"outline",className:"bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-300 border-orange-300",children:"Not Found"}),e.jsx("span",{className:"text-sm",children:"Not in search results"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{variant:"outline",className:"bg-muted",children:"Not checked"}),e.jsx("span",{className:"text-sm",children:"Never checked"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{variant:"destructive",className:"bg-red-600 text-white",children:"Error"}),e.jsx("span",{className:"text-sm",children:"API error"})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("h4",{className:"text-sm font-medium mb-2 flex items-center gap-2",children:[e.jsx(xe,{className:"w-4 h-4"}),"Trend Indicators"]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-bold text-green-600 dark:text-green-400",children:"↑5"}),e.jsx("span",{children:"Improved 5 positions"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-bold text-red-600 dark:text-red-400",children:"↓3"}),e.jsx("span",{children:"Declined 3 positions"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"—"}),e.jsx("span",{children:"No change"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"-"}),e.jsx("span",{children:"No historical data"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Trends show position changes over 7 days, 30 days, and 90 days. Data is saved automatically when you check rankings."})]})]})]})]})]})}export{Se as default};
