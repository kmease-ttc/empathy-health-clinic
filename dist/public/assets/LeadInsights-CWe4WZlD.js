import{u as M,j as e,a as C,g as F,C as l,c as i,d as c,U as W,e as a,m as z,q as B,F as j,P as E}from"./index-CgsemtNf.js";import{T as K,a as Q,b as f,c as u}from"./tabs-BonmKIaG.js";import{T as V}from"./trending-up-KAb4bHo1.js";import{T as X}from"./trending-down-0OaeVcYU.js";import{F as T}from"./file-text-DR4XjJnC.js";import{C as G}from"./circle-x-DMZ_l0I7.js";function te(){const{data:t,isLoading:L}=M({queryKey:["/api/leads"]});if(L)return e.jsxs("div",{className:"min-h-screen flex flex-col bg-background",children:[e.jsx(C,{}),e.jsx("main",{className:"flex-1 flex items-center justify-center",children:e.jsx("p",{className:"text-muted-foreground",children:"Loading insights..."})}),e.jsx(F,{})]});const d=(t==null?void 0:t.length)||0,g=(t==null?void 0:t.filter(s=>s.status==="signed_up").length)||0,R=(t==null?void 0:t.filter(s=>s.status==="rejected").length)||0,S=(t==null?void 0:t.filter(s=>s.status==="new").length)||0,N=d>0?(g/d*100).toFixed(1):"0",o=(t==null?void 0:t.filter(s=>s.formType==="short"||s.formType==="hero"))||[],x=(t==null?void 0:t.filter(s=>s.formType==="long"))||[],m=(t==null?void 0:t.filter(s=>s.formType==="phone"))||[],v=o.filter(s=>s.status==="signed_up").length,b=x.filter(s=>s.status==="signed_up").length,y=m.filter(s=>s.status==="signed_up").length,D=o.length>0?(v/o.length*100).toFixed(1):"0",k=x.length>0?(b/x.length*100).toFixed(1):"0",U=m.length>0?(y/m.length*100).toFixed(1):"0",_=t==null?void 0:t.filter(s=>s.rejectionReason).reduce((s,r)=>{const n=r.rejectionReason||"Unknown";return s[n]=(s[n]||0)+1,s},{}),w=Object.entries(_||{}).sort(([,s],[,r])=>r-s).slice(0,5),P=t==null?void 0:t.reduce((s,r)=>{const n=r.utmSource||"Direct";return s[n]||(s[n]={total:0,converted:0}),s[n].total++,r.status==="signed_up"&&s[n].converted++,s},{}),q=Object.entries(P||{}).map(([s,r])=>({source:s,...r,rate:r.total>0?(r.converted/r.total*100).toFixed(1):"0"})).sort((s,r)=>r.total-s.total).slice(0,5),A=t==null?void 0:t.reduce((s,r)=>{const n=r.service||"Unknown";return s[n]||(s[n]={total:0,converted:0}),s[n].total++,r.status==="signed_up"&&s[n].converted++,s},{}),I=Object.entries(A||{}).map(([s,r])=>({service:s,...r,rate:r.total>0?(r.converted/r.total*100).toFixed(1):"0"})).sort((s,r)=>r.total-s.total).slice(0,5),p=new Date;p.setDate(p.getDate()-7);const h=(t==null?void 0:t.filter(s=>new Date(s.createdAt)>=p))||[],O=h.filter(s=>s.status==="signed_up").length,H=h.length>0?(O/h.length*100).toFixed(1):"0";return e.jsxs("div",{className:"min-h-screen flex flex-col bg-background",children:[e.jsx(C,{}),e.jsx("main",{className:"flex-1 py-8",children:e.jsxs("div",{className:"container mx-auto px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-foreground mb-2",children:"Lead Insights"}),e.jsx("p",{className:"text-muted-foreground",children:"Analyze conversion patterns and identify opportunities"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsxs(l,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Total Leads"}),e.jsx(W,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(a,{children:[e.jsx("div",{className:"text-2xl font-bold",children:d}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All time"})]})]}),e.jsxs(l,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Conversion Rate"}),parseFloat(N)>=50?e.jsx(V,{className:"h-4 w-4 text-green-500"}):e.jsx(X,{className:"h-4 w-4 text-red-500"})]}),e.jsxs(a,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[N,"%"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[g," of ",d," signed up"]})]})]}),e.jsxs(l,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"New Leads"}),e.jsx(z,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(a,{children:[e.jsx("div",{className:"text-2xl font-bold",children:S}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting contact"})]})]}),e.jsxs(l,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Last 7 Days"}),e.jsx(B,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(a,{children:[e.jsx("div",{className:"text-2xl font-bold",children:h.length}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[H,"% conversion rate"]})]})]})]}),e.jsxs(K,{defaultValue:"forms",className:"space-y-6",children:[e.jsxs(Q,{children:[e.jsx(f,{value:"forms",children:"Form Performance"}),e.jsx(f,{value:"sources",children:"Traffic Sources"}),e.jsx(f,{value:"rejections",children:"Rejection Reasons"}),e.jsx(f,{value:"services",children:"Services"})]}),e.jsx(u,{value:"forms",className:"space-y-6",children:e.jsxs(l,{children:[e.jsxs(i,{children:[e.jsx(c,{children:"Form Type Performance"}),e.jsx(j,{children:"Compare conversion rates across different lead capture forms"})]}),e.jsx(a,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center",children:e.jsx(T,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Long Form"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[x.length," leads"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-2xl font-bold text-primary",children:[k,"%"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[b," converted"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center",children:e.jsx(T,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Short Form"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[o.length," leads"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-2xl font-bold text-primary",children:[D,"%"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[v," converted"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center",children:e.jsx(E,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Phone Inquiries"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[m.length," leads"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-2xl font-bold text-primary",children:[U,"%"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[y," converted"]})]})]})]})})]})}),e.jsx(u,{value:"sources",className:"space-y-6",children:e.jsxs(l,{children:[e.jsxs(i,{children:[e.jsx(c,{children:"Top Traffic Sources"}),e.jsx(j,{children:"Which marketing channels drive the most conversions"})]}),e.jsx(a,{children:e.jsx("div",{className:"space-y-4",children:q.map((s,r)=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:s.source}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.total," total leads"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-xl font-bold text-primary",children:[s.rate,"%"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.converted," converted"]})]})]},r))})})]})}),e.jsx(u,{value:"rejections",className:"space-y-6",children:e.jsxs(l,{children:[e.jsxs(i,{children:[e.jsx(c,{children:"Top Rejection Reasons"}),e.jsx(j,{children:"Why leads don't convert - opportunities for improvement"})]}),e.jsx(a,{children:w.length>0?e.jsx("div",{className:"space-y-4",children:w.map(([s,r],n)=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-red-100 dark:bg-red-900/20 rounded-full flex items-center justify-center",children:e.jsx(G,{className:"h-5 w-5 text-red-600 dark:text-red-400"})}),e.jsx("p",{className:"font-semibold",children:s})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xl font-bold",children:r}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[(r/R*100).toFixed(1),"% of rejections"]})]})]},n))}):e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No rejection data yet"})})]})}),e.jsx(u,{value:"services",className:"space-y-6",children:e.jsxs(l,{children:[e.jsxs(i,{children:[e.jsx(c,{children:"Service Popularity"}),e.jsx(j,{children:"Most requested services and their conversion rates"})]}),e.jsx(a,{children:e.jsx("div",{className:"space-y-4",children:I.map((s,r)=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:s.service}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.total," requests"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-xl font-bold text-primary",children:[s.rate,"%"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.converted," converted"]})]})]},r))})})]})})]})]})}),e.jsx(F,{})]})}export{te as default};
