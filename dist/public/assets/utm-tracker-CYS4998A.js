const n="utm_params",r="utm_expiry",i="utm_landing_page";const s="gclid_session",c="fbclid_session",g=e=>{const t=e?new URL(e).searchParams:new URLSearchParams(window.location.search);return{utmSource:t.get("utm_source")||void 0,utmMedium:t.get("utm_medium")||void 0,utmCampaign:t.get("utm_campaign")||void 0,utmTerm:t.get("utm_term")||void 0,utmContent:t.get("utm_content")||void 0,gclid:t.get("gclid")||void 0,fbclid:t.get("fbclid")||void 0}},a=e=>!!(e.utmSource||e.utmMedium||e.utmCampaign||e.utmTerm||e.utmContent||e.gclid||e.fbclid),u=e=>{if(!(typeof window>"u"))try{e.gclid&&(sessionStorage.setItem(s,e.gclid),console.log("ðŸŽ¯ UTM Tracking: GCLID saved to session storage:",e.gclid.substring(0,10)+"...")),e.fbclid&&(sessionStorage.setItem(c,e.fbclid),console.log("ðŸŽ¯ UTM Tracking: FBCLID saved to session storage"))}catch{console.warn("âš ï¸ UTM Tracking: Could not save to sessionStorage")}},S=()=>{if(typeof window>"u")return{};try{return{gclid:sessionStorage.getItem(s)||void 0,fbclid:sessionStorage.getItem(c)||void 0}}catch{return{}}},m=(e,t)=>{if(typeof window>"u"||!a(e))return;const o=new Date;o.setDate(o.getDate()+30),localStorage.setItem(n,JSON.stringify(e)),localStorage.setItem(r,o.toISOString()),localStorage.setItem(i,t)},d=()=>{if(typeof window>"u")return null;try{const e=localStorage.getItem(n),t=localStorage.getItem(r),o=localStorage.getItem(i);if(!e||!t)return null;const l=new Date(t);return new Date>l?(localStorage.removeItem(n),localStorage.removeItem(r),localStorage.removeItem(i),null):{...JSON.parse(e),landingPage:o||void 0}}catch(e){return console.error("Error reading UTM params from storage:",e),null}},I=()=>{if(typeof window>"u")return;const e=g();if((e.gclid||e.fbclid)&&u(e),a(e)&&!d()){const o=window.location.pathname;m(e,o),console.log("ðŸŽ¯ UTM Tracking: First-touch attribution saved",{...e,landingPage:o})}},v=()=>{const e=d();if(e)return e;const t=g();return a(t)?{...t,landingPage:window.location.pathname}:{}},T=()=>{typeof window>"u"||(localStorage.removeItem(n),localStorage.removeItem(r),localStorage.removeItem(i))};export{T as clearUTMData,g as extractUTMParams,d as getSavedUTMParams,S as getSessionClickIds,v as getUTMDataForLead,a as hasUTMParams,I as initUTMTracking,u as saveClickIdsToSession,m as saveUTMParams};
