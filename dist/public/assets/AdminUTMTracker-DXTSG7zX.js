import{G as u,N as _,u as R,j as e,C as c,c as d,d as m,F as x,B as i,e as l,f as P,W as G}from"./index-CgsemtNf.js";import{B as r}from"./badge-CYF5D6iW.js";import{A as T,b}from"./alert-p0mUESB5.js";import{getSavedUTMParams as D,clearUTMData as E,extractUTMParams as B}from"./utm-tracker-CYS4998A.js";import{C}from"./circle-alert-DGxppOlc.js";import{T as q}from"./trash-2-BGg7VW7-.js";import{C as z}from"./circle-x-DMZ_l0I7.js";import{C as M}from"./copy-BBkmrkc5.js";import{T as I}from"./trending-up-KAb4bHo1.js";import{R as O}from"./refresh-cw-BXMHVCn8.js";import{E as w}from"./external-link-Dqi3fO-u.js";function ee(){const[a,j]=u.useState(null),[h,U]=u.useState(""),[t,k]=u.useState(null),{toast:o}=_(),{data:n,refetch:A}=R({queryKey:["/api/leads"]});u.useEffect(()=>{const s=D();j(s)},[]);const S=()=>{E(),j(null),o({title:"UTM data cleared",description:"Visit a page with UTM parameters to test tracking."})},L=()=>{if(h)try{const s=B(h);k(s);const p=s.utmSource||s.utmMedium||s.utmCampaign;o({title:p?"UTM parameters found!":"No UTM parameters",description:p?`Found ${Object.values(s).filter(Boolean).length} parameters`:"Add UTM parameters to your URL",variant:p?"default":"destructive"})}catch{o({title:"Invalid URL",description:"Please enter a valid URL with https://",variant:"destructive"})}},g=s=>{navigator.clipboard.writeText(s),o({title:"Copied!",description:"URL copied to clipboard"})},f="https://empathyhealthclinic.com/request-appointment?utm_source=google&utm_medium=cpc&utm_campaign={campaignid}&utm_term={keyword}&utm_content={creative}",N="https://empathyhealthclinic.com/request-appointment?utm_source=google&utm_medium=cpc&utm_campaign=psychiatry_orlando&utm_term=psychiatrist+orlando",v=(n==null?void 0:n.filter(s=>s.utmSource||s.utmMedium||s.utmCampaign).slice(0,10))||[],y=(n==null?void 0:n.filter(s=>s.utmMedium==="cpc"||s.utmMedium==="paidsearch").length)||0;return e.jsx("div",{className:"min-h-screen bg-background p-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold mb-2","data-testid":"heading-utm-tracker",children:"UTM Parameter Tracker"}),e.jsx("p",{className:"text-muted-foreground",children:"Monitor and verify UTM tracking for Google Ads and Microsoft Clarity"})]}),e.jsxs(T,{"data-testid":"alert-clarity-setup",children:[e.jsx(C,{className:"h-4 w-4"}),e.jsxs(b,{children:[e.jsx("strong",{children:"Microsoft Clarity Issue:"})," Only ",y,' paid search leads detected. Most Google Ads traffic is appearing as "Direct" because UTM parameters are missing.',e.jsx("br",{}),e.jsx("strong",{children:"Solution:"})," Add the URL template below to your Google Ads account settings."]})]}),e.jsxs(c,{"data-testid":"card-current-utm",children:[e.jsx(d,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(m,{children:"Current Session Attribution"}),e.jsx(x,{children:"UTM parameters saved for this browser (30-day first-touch)"})]}),a&&e.jsxs(i,{variant:"outline",size:"sm",onClick:S,"data-testid":"button-clear-utm",children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Clear"]})]})}),e.jsx(l,{children:a?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[e.jsx(P,{className:"h-5 w-5"}),e.jsx("span",{className:"font-medium",children:"UTM Tracking Active"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[a.utmSource&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Source:"}),e.jsx(r,{variant:"secondary","data-testid":"badge-utm-source",children:a.utmSource})]}),a.utmMedium&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Medium:"}),e.jsx(r,{variant:"secondary","data-testid":"badge-utm-medium",children:a.utmMedium})]}),a.utmCampaign&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Campaign:"}),e.jsx(r,{variant:"secondary","data-testid":"badge-utm-campaign",children:a.utmCampaign})]}),a.utmTerm&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Term:"}),e.jsx(r,{variant:"secondary","data-testid":"badge-utm-term",children:a.utmTerm})]}),a.landingPage&&e.jsxs("div",{className:"flex items-center gap-2 md:col-span-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Landing Page:"}),e.jsx("code",{className:"text-sm bg-muted px-2 py-1 rounded",children:a.landingPage})]})]})]}):e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(z,{className:"h-5 w-5"}),e.jsx("span",{children:"No UTM parameters detected. Visit a page with UTM parameters to test."})]})})]}),e.jsxs(c,{"data-testid":"card-google-ads-config",children:[e.jsxs(d,{children:[e.jsx(m,{children:"Google Ads URL Template"}),e.jsx(x,{children:"Add this to Google Ads → Settings → Account Settings → Tracking Template"})]}),e.jsxs(l,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Automatic Template (Recommended)"}),e.jsxs(i,{variant:"outline",size:"sm",onClick:()=>g(f),"data-testid":"button-copy-auto-template",children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"Copy"]})]}),e.jsx("code",{className:"block bg-muted p-3 rounded text-xs break-all",children:f}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Uses dynamic Google Ads parameters: ","{campaignid}",", ","{keyword}",", ","{creative}"]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Manual Template (Testing)"}),e.jsxs(i,{variant:"outline",size:"sm",onClick:()=>g(N),"data-testid":"button-copy-manual-template",children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"Copy"]})]}),e.jsx("code",{className:"block bg-muted p-3 rounded text-xs break-all",children:N}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Use this for manual testing with static campaign names"})]}),e.jsxs(T,{children:[e.jsx(C,{className:"h-4 w-4"}),e.jsxs(b,{className:"text-sm",children:[e.jsx("strong",{children:"Important:"})," After adding this template to Google Ads:",e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:"Wait 2-4 hours for Clarity to update"}),e.jsx("li",{children:"Test by clicking your own ad (use mobile/incognito)"}),e.jsx("li",{children:"Check this page to verify UTM parameters were captured"}),e.jsx("li",{children:'Clarity will now show sessions under "Paid Search" instead of "Direct"'})]})]})]})]})]}),e.jsxs(c,{"data-testid":"card-url-tester",children:[e.jsxs(d,{children:[e.jsx(m,{children:"Test URL Parameters"}),e.jsx(x,{children:"Paste a URL to see what UTM parameters will be captured"})]}),e.jsxs(l,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(G,{placeholder:"https://empathyhealthclinic.com/request-appointment?utm_source=google&utm_medium=cpc...",value:h,onChange:s=>U(s.target.value),"data-testid":"input-test-url"}),e.jsx(i,{onClick:L,"data-testid":"button-test-url",children:"Test"})]}),t&&e.jsxs("div",{className:"border rounded-lg p-4 bg-muted/50",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Extracted Parameters:"}),t.utmSource||t.utmMedium||t.utmCampaign?e.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[t.utmSource&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"utm_source:"}),e.jsx("p",{className:"font-mono text-sm",children:t.utmSource})]}),t.utmMedium&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"utm_medium:"}),e.jsx("p",{className:"font-mono text-sm",children:t.utmMedium})]}),t.utmCampaign&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"utm_campaign:"}),e.jsx("p",{className:"font-mono text-sm",children:t.utmCampaign})]}),t.utmTerm&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"utm_term:"}),e.jsx("p",{className:"font-mono text-sm",children:t.utmTerm})]}),t.utmContent&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"utm_content:"}),e.jsx("p",{className:"font-mono text-sm",children:t.utmContent})]})]}):e.jsx("p",{className:"text-muted-foreground",children:"No UTM parameters found in URL"})]})]})]}),e.jsxs(c,{"data-testid":"card-recent-leads",children:[e.jsx(d,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(m,{children:"Recent Leads with Attribution"}),e.jsx(x,{children:"Last 10 form submissions with UTM tracking data"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(r,{variant:"outline",className:"gap-1",children:[e.jsx(I,{className:"h-3 w-3"}),y," Paid"]}),e.jsx(i,{variant:"outline",size:"sm",onClick:()=>A(),"data-testid":"button-refresh-leads",children:e.jsx(O,{className:"h-4 w-4"})})]})]})}),e.jsx(l,{children:v.length>0?e.jsx("div",{className:"space-y-3",children:v.map(s=>e.jsxs("div",{className:"border rounded-lg p-4 space-y-2","data-testid":`lead-${s.id}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:s.name||`Lead #${s.id}`}),e.jsx("span",{className:"text-xs text-muted-foreground",children:new Date(s.createdAt).toLocaleDateString()})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.utmSource&&e.jsxs(r,{variant:"secondary",className:"text-xs",children:["Source: ",s.utmSource]}),s.utmMedium&&e.jsxs(r,{variant:"secondary",className:"text-xs",children:["Medium: ",s.utmMedium]}),s.utmCampaign&&e.jsxs(r,{variant:"secondary",className:"text-xs",children:["Campaign: ",s.utmCampaign]}),s.utmTerm&&e.jsxs(r,{variant:"secondary",className:"text-xs",children:["Keyword: ",s.utmTerm]})]})]},s.id))}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx("p",{children:"No leads with UTM attribution yet"}),e.jsx("p",{className:"text-sm mt-2",children:"Leads will appear here once you configure Google Ads UTM parameters"})]})})]}),e.jsxs(c,{children:[e.jsx(d,{children:e.jsx(m,{children:"External Resources"})}),e.jsxs(l,{className:"space-y-2",children:[e.jsx(i,{variant:"outline",className:"w-full justify-start",asChild:!0,"data-testid":"button-clarity-dashboard",children:e.jsxs("a",{href:"https://clarity.microsoft.com/",target:"_blank",rel:"noopener noreferrer",children:[e.jsx(w,{className:"h-4 w-4 mr-2"}),"Open Microsoft Clarity Dashboard"]})}),e.jsx(i,{variant:"outline",className:"w-full justify-start",asChild:!0,"data-testid":"button-google-ads",children:e.jsxs("a",{href:"https://ads.google.com/aw/settings/tracking",target:"_blank",rel:"noopener noreferrer",children:[e.jsx(w,{className:"h-4 w-4 mr-2"}),"Configure Google Ads Tracking"]})})]})]})]})})}export{ee as default};
